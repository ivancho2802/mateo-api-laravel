-- ver los kobo respuestas que son las respuestas de los kobos

SELECT * FROM M_KOBO_RESPUESTAS WHERE ID_M_KOBO_FORMULARIOS='0017830 ' --  
-- ver los tickets de soporte

SELECT * FROM D_FALLAS -- 
-- ver los datos del formulario de kobo

SELECT * FROM M_KOBO_FORMULARIOS WHERE ID_M_KOBO_FORMULARIOS='0017823' --

-- ver los municipios de una lista desplegable de kobo
SELECT NOMBRES        FROM M_MUNICIPIOS        WHERE  CAMPO1 = '19824_totoro'        ROWS 1 -- 

-- ver las preguntas de un formulario relacionado el m_kobo_fromulario
SELECT * FROM P_FORMULARIOS  WHERE REFERENCIA = 'Estado_de_la_emergencia'   -- AND ID_M_FORMULARIOS = '0011' -- -- 

-- ver los detalles de un usuario de kobo
SELECT * FROM M_USUARIOS WHERE ID_M_USUARIO IN (001152,001298)  --  (

-- ver los detalles de un kobo_formulario pare ver el codigo de una alerta que eun campo especial contruido con datos de departamento y municipio
SELECT COALESCE(CODIGO_ALERTA,0) + 1          FROM M_KOBO_FORMULARIOS          WHERE XCODIGO_ALERTA NOT LIKE 'RT-%'          ORDER BY CODIGO_ALERTA DESC          ROWS 1 -- 

-- actualizando una plkantilla de formulario que es como los detallas globales de un fomulario del cual se relaciona una plantilla de correos 
UPDATE M_FORMULARIOS SET UID = 'a2qmowz5ThpAqH4bTDieHA', URL_DATA = 'https://kobo.humanitarianresponse.info/api/v2/assets/a2qmowz5ThpAqH4bTDieHA/data.json', URL_CAMPOS='https://kobo.humanitarianresponse.info/api/v2/assets/a2qmowz5ThpAqH4bTDieHA.xml' WHERE ID_M_FORMULARIOS = '0011' -- 

-- viendo correo pendiente
SELECT * FROM D_CORREO WHERE ESTATUS='PENDIENTE' --

-- ver los grupos que se generan para el menu los cuales estan relacionados con los grupos de roles o permisos dentro del mireview
SELECT * from i_menu_grup where url like '%rt_matriz_segui_%' -- id_m_grupos = 'XXXXGRUP0013' -- 
INSERT into v_i_menu_grup values()  
SELECT * from v_i_menu_grup where id_m_grupos = 'XXXXGRUP0013' -- 
UPDATE i_menu_grup SET POSICION = 5 WHERE ID_I_MENU_GRUP = '001203' --  order by posicion -- 
SELECT * FROM i_menu_grup WHERE  URL LIKE '%rr_productos_informacion%' -- 
UPDATE i_menu_grup SET POSICION = 5 WHERE  URL LIKE '%rr_productos_informacion%'  --  -- 
SELECT * from v_i_menu_grup where id_m_grupos = 'XXXXGRUP0012' order by posicion 
SELECT                     CODIGO,           ESTAT,           cast(cast(DPTO as blob sub_type text character set ISO8859_1) as varchar(2000)) DEPARTAMENTO,           cast(cast(MUNICIP as blob sub_type text character set ISO8859_1) as varchar(2000)) MUNICIP,                     cast(cast(ESTADO_EMERGENCIA as blob sub_type text character set ISO8859_1) as varchar(2000)) ESTADO_EMERGENCIA,           cast(cast(TIPO_EMERGENCIA as blob sub_type text character set ISO8859_1) as varchar(2000))      TIPO_EMERGENCIA,                cast(cast(fecha_evento as blob sub_type text character set ISO8859_1) as varchar(2000)) fecha_evento,           cast(cast(FECHA_ALERTA as blob sub_type text character set ISO8859_1) as varchar(2000))      FECHA_ALERTA,           SOCIO_LIDER ,               RESPUESTA_LOCAL,           ENLACE_FSA,          SECTOR_NECESIDAD from                         (                  
SELECT                         CODIGO,                           ESTAT,                           ESTADO_EMERGENCIA,                          TIPO_EMERGENCIA,                           fecha_evento,                         IDFORM,                           FECHA_RECEPCION,                         MUNICIP,                          FECHA_ALERTA,                          DPTO,                          SOCIO_LIDER,                          ENLACE_FSA,                          RESPUESTA_LOCAL,                          M_KOBO_RESPUESTAS.XVALOR SECTOR_NECESIDAD                              from                         (                                
SELECT                                 CODIGO,                 ESTAT,                 ESTADO_EMERGENCIA,                 TIPO_EMERGENCIA,                 fecha_evento,                 IDFORM,                 FECHA_RECEPCION,                 MUNICIP,                 FECHA_ALERTA,                 DPTO,                 SOCIO_LIDER,                 ENLACE_FSA,                 M_KOBO_RESPUESTAS.XVALOR RESPUESTA_LOCAL                from                                 (                           
SELECT                              CODIGO,                         ESTAT,                         ESTADO_EMERGENCIA,                         TIPO_EMERGENCIA,                         fecha_evento,                         IDFORM,                         FECHA_RECEPCION,                         MUNICIP,                         FECHA_ALERTA,                         DPTO,                         SOCIO_LIDER,                         M_KOBO_RESPUESTAS.XVALOR ENLACE_FSA                                    from                              (                               
SELECT                                                  CODIGO,                                 ESTAT,                                 ESTADO_EMERGENCIA,                                 TIPO_EMERGENCIA,                                 fecha_evento,                                 IDFORM,                                 FECHA_RECEPCION,                                 MUNICIP,                                 FECHA_ALERTA,                                 DPTO,                                 M_KOBO_RESPUESTAS.XVALOR SOCIO_LIDER                                 from                                                  (                                                               
SELECT                                                  CODIGO,                                         ESTAT,                                         ESTADO_EMERGENCIA,                                         TIPO_EMERGENCIA,                                         M_KOBO_RESPUESTAS.XVALOR fecha_evento,                                         IDFORM,                                         FECHA_RECEPCION,                                         MUNICIP,                                         FECHA_ALERTA,                                         DPTO                                                             from                                                  (                                                                  
SELECT                                                           CODIGO,                                                 ESTAT,                                                 M_KOBO_RESPUESTAS.XVALOR FECHA_ALERTA,                                                 ESTADO_EMERGENCIA,                                                 TIPO_EMERGENCIA,                                                 IDFORM,                                                 FECHA_RECEPCION,                                                 MUNICIP,                                                 DPTO                                               FROM                                                                      (                                                                               
SELECT                                                                   CODIGO,                                                                ESTAT,                                                                M_KOBO_RESPUESTAS.XVALOR ESTADO_EMERGENCIA,                                                               TIPO_EMERGENCIA,                                                         IDFORM,                                                         FECHA_RECEPCION,                                                         MUNICIP,                                                         DPTO                                                       FROM                                                               (                                                                
SELECT                                                                                M_KOBO_RESPUESTAS.XVALOR TIPO_EMERGENCIA,                                                                 m_kobo_formularios.xCODIGO_ALERTA CODIGO,                                                                 m_kobo_formularios.fecha FECHA_RECEPCION,                                                                 M_KOBO_FORMULARIOS.MUNICIPIO MUNICIP,                                                                 M_KOBO_FORMULARIOS.DEPARTAMENTO DPTO,                                                                 M_KOBO_RESPUESTAS.ID_M_KOBO_FORMULARIOS IDFORM,                                                                 m_kobo_formularios.ESTATUS ESTAT                                                                       FROM                                                                                M_KOBO_RESPUESTAS                                                                INNER JOIN                                                                                M_KOBO_FORMULARIOS   ON               M_KOBO_RESPUESTAS.ID_M_KOBO_FORMULARIOS=M_KOBO_FORMULARIOS.ID_M_KOBO_FORMULARIOS                                                                       WHERE                                                                                M_KOBO_RESPUESTAS.ID_P_FORMULARIOS='001475' and m_kobo_formularios.id_m_formularios='0011'                                                               )                                                             INNER JOIN                                                                       M_KOBO_RESPUESTAS  ON              IDFORM=M_KOBO_RESPUESTAS.ID_M_KOBO_FORMULARIOS                                                       WHERE                                                                       M_KOBO_RESPUESTAS.ID_P_FORMULARIOS='0012173'                                                      )                                               INNER JOIN                                                               M_KOBO_RESPUESTAS  ON              IDFORM=M_KOBO_RESPUESTAS.ID_M_KOBO_FORMULARIOS                                               WHERE                                                               M_KOBO_RESPUESTAS.ID_P_FORMULARIOS='001428'                                             )                                                              INNER JOIN                                                  M_KOBO_RESPUESTAS                         ON         IDFORM=M_KOBO_RESPUESTAS.ID_M_KOBO_FORMULARIOS                                                              WHERE                                                  M_KOBO_RESPUESTAS.ID_P_FORMULARIOS='001477'                                             )                                     INNER JOIN                                                      M_KOBO_RESPUESTAS         ON                     IDFORM=M_KOBO_RESPUESTAS.ID_M_KOBO_FORMULARIOS                                      WHERE                                                      M_KOBO_RESPUESTAS.ID_P_FORMULARIOS='0012170'                                        )                                        INNER JOIN                                  M_KOBO_RESPUESTAS                    ON         IDFORM=M_KOBO_RESPUESTAS.ID_M_KOBO_FORMULARIOS                                         WHERE                                  M_KOBO_RESPUESTAS.ID_P_FORMULARIOS='0012172'                  )                    INNER JOIN                                     M_KOBO_RESPUESTAS        ON                    IDFORM=M_KOBO_RESPUESTAS.ID_M_KOBO_FORMULARIOS                     WHERE                                     M_KOBO_RESPUESTAS.ID_P_FORMULARIOS='001490'              )        INNER JOIN                         M_KOBO_RESPUESTAS    ON                IDFORM=M_KOBO_RESPUESTAS.ID_M_KOBO_FORMULARIOS         WHERE                         M_KOBO_RESPUESTAS.ID_P_FORMULARIOS='001482'         )  -- 
SELECT * from v_i_menu_grup where id_m_grupos = 'XXXXGRUP0012' -- 
UPDATE i_menu_grup SET POSICION = 5 WHERE ID_I_MENU_GRUP = '001203' --  order by posicion -- 
SELECT * FROM i_menu_grup WHERE  URL LIKE '%rr_productos_informacion%' -- 
UPDATE i_menu_grup SET POSICION = 5 WHERE  URL LIKE '%rr_productos_informacion%'  --  -- 
SELECT * from v_i_menu_grup where id_m_grupos = 'XXXXGRUP0012' order by posicion --   
SELECT  LEFT( UPPER(XROTULO), 1 )  ||  RIGHT( LOWER(XROTULO), CHAR_LENGTH(XROTULO)-1 ) AS ROTULO, LEFT( UPPER(VALOR), 1 )  ||  RIGHT( LOWER(VALOR), CHAR_LENGTH(VALOR)-1 ) AS VALOR FROM V_M_KOBO_RESPUESTAS WHERE ID_M_KOBO_FORMULARIOS ='0016446' AND ID_P_FORMULARIOS IN ('001428','001427','001429','001472', '001469','001473','001475','001577','001486','001484','001485') ORDER BY POSICION_GRUPO,POSICION,XROTULO,XROTULO_PLANTILLA -- 

-- cuando los datos llegan de kobo estos se guardan directamente en esta tabla para posterioemnete despues con tigger almacenarlo en las tablas relacionadas con los datos de preguntas y respuestas 
SELECT * FROM TMP_RESPUESTAS WHERE ID_M_FORMULARIOS = '0011' ORDER BY  FECHA DESC ROWS 1 TO 1000  

-- ver los formularios con las respuetas
SELECT * FROM V_M_KOBO_FORMULARIOS WHERE ID_M_KOBO_FORMULARIOS ='0016419' --   


SELECT rdb$view_source from rdb$relations where rdb$relation_name = 'T_KOBO_RESPUESTAS'  -- para ver el contenido de las vistas",


TIGGERS


CREATE VIEW V_M_KOBO_FORMULARIOS_RTPT(
  ID_M_KOBO_FORMULARIOS,
  ID_M_USUARIOS,
  FECHA,
  FECHA_REGISTRO,
  ID,
  ESTATUS,
  ID_M_FORMULARIOS,
  FECHA_FORMULARIO,
  UID,
  FUID,
  NOMBRE_FORMULARIO,
  GRUPO,
  NOMBRE_ESTATUS,
  NOMBRE_USUARIO,
  FECHA_ESTADISTICA,
  REGION,
  DEPARTAMENTO,
  MUNICIPIO,
  CODIGO_ALERTA)
AS
SELECT
  M_KOBO_FORMULARIOS.ID_M_KOBO_FORMULARIOS,
  M_KOBO_FORMULARIOS.ID_M_USUARIOS,
  M_KOBO_FORMULARIOS.FECHA,
  M_KOBO_FORMULARIOS.FECHA_REGISTRO,
  M_KOBO_FORMULARIOS.ID,
  M_KOBO_FORMULARIOS.ESTATUS,
  M_KOBO_FORMULARIOS.ID_M_FORMULARIOS,
  M_KOBO_FORMULARIOS.FECHA_FORMULARIO,
  M_KOBO_FORMULARIOS.UID,
  UPPER(M_KOBO_FORMULARIOS.FUID) AS FUID,
  COALESCE(M_FORMULARIOS.NOMBRES,'Sintesis de resultados - Recoleccion de informacion para la focalizacion de comunidades MIRE+') AS NOMBRE_FORMULARIO,
  M_FORMULARIOS.GRUPO,
  M_TERMINOS.NOMBRES AS NOMBRE_ESTATUS,
  M_USUARIOS.NOMBRE_COMPLETO AS NOMBRE_USUARIO,
  M_KOBO_FORMULARIOS.FECHA_ESTADISTICA,
  M_KOBO_FORMULARIOS.REGION,
  M_KOBO_FORMULARIOS.DEPARTAMENTO,
  M_KOBO_FORMULARIOS.MUNICIPIO,
  M_KOBO_FORMULARIOS.XCODIGO_ALERTA AS CODIGO_ALERTA
FROM
  M_KOBO_FORMULARIOS
  LEFT OUTER JOIN M_TERMINOS ON (M_KOBO_FORMULARIOS.ESTATUS = M_TERMINOS.CODIGO1)
  LEFT OUTER JOIN M_USUARIOS ON (M_KOBO_FORMULARIOS.ID_M_USUARIOS = M_USUARIOS.ID_M_USUARIO)
  LEFT OUTER JOIN M_FORMULARIOS ON (M_KOBO_FORMULARIOS.ID_M_FORMULARIOS = M_FORMULARIOS.ID_M_FORMULARIOS)
WHERE
  (M_KOBO_FORMULARIOS.ID_M_FORMULARIOS = 1121)
;